<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>ğŸï¸ Fly Rider â€” Ø§Ù„Ø¹Ø¨ ÙˆØ§ÙƒØ³Ø¨ ØªÙˆØµÙŠÙ„Ø© Ù…Ø¬Ø§Ù†ÙŠØ©</title>
<style>
  :root{--ui:#0e2a3d;--text:#143a52;--muted:#5a7a8e;--chip:#fff;--chipb:#e7eff6;--accent:#22c55e}
  *{box-sizing:border-box}
  html,body{height:100%}
  body{margin:0;font-family:"Cairo",system-ui,sans-serif;background:linear-gradient(#eaf6ff,#ffffff);color:var(--ui)}
  .wrap{max-width:960px;margin:0 auto;padding:16px;text-align:center}
  h1{margin:10px 0;font-size:28px;font-weight:900}
  .row{display:flex;gap:10px;justify-content:center;flex-wrap:wrap}
  .chip{background:var(--chip);border:1px solid var(--chipb);border-radius:14px;padding:10px 14px;font-weight:800}
  .btn{cursor:pointer;border:none;border-radius:999px;padding:10px 16px;background:var(--accent);color:#fff;font-weight:900;box-shadow:0 10px 20px rgba(34,197,94,.35)}
  #game{display:block;width:100%;max-width:960px;height:320px;border-radius:14px;border:1px solid #dfe8f0;background:#f8fcff;box-shadow:0 8px 20px rgba(0,0,0,.06)}
  .overlay{position:absolute;inset:0;display:grid;place-items:center;text-align:center;background:rgba(255,255,255,.55);backdrop-filter:blur(3px);border-radius:14px;font-weight:900}
  .overlay.hidden{display:none}
  .toast{position:fixed;bottom:12px;left:50%;transform:translateX(-50%);background:#fff;border:1px solid #e6eef5;border-radius:16px;padding:12px 14px;box-shadow:0 10px 24px rgba(0,0,0,.12);display:none;text-align:center}
  .toast.show{display:block;animation:pop .3s ease}
  @keyframes pop{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}
</style>
</head>
<body>
<div class="wrap">
  <div class="row">
    <button id="btnStart" class="btn">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨</button>
    <button id="btnSound" class="chip">ğŸ”Š ØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙˆØª</button>
  </div>
  <h1>ğŸï¸ Fly Rider â€” Ø§Ù„Ø¹Ø¨ ÙˆØ§ÙƒØ³Ø¨ ØªÙˆØµÙŠÙ„Ø© Ù…Ø¬Ø§Ù†ÙŠØ©</h1>
  <div class="row">
    <div class="chip">Ø§Ù„Ù…Ø³Ø§ÙØ©: <span id="dist">0</span> / 10000</div>
    <div class="chip">Ø£Ø¹Ù„Ù‰ Ù†ØªÙŠØ¬Ø©: <span id="best">0</span></div>
  </div>
  <div style="position:relative;margin-top:10px">
    <canvas id="game" width="960" height="320"></canvas>
    <div id="overlay" class="overlay">
      Ø§Ø¶ØºØ· Ø£Ùˆ Ø§Ù„Ù…Ø³ Ø§Ù„Ø´Ø§Ø´Ø© Ù„Ù„Ø§Ù†Ø·Ù„Ø§Ù‚<br>Ø§Ù„Ù‡Ø¯Ù: 10000 Ù†Ù‚Ø·Ø© â€” Ø§Ù‚ÙØ² ÙˆØªÙØ§Ø¯Ù Ø§Ù„Ø¹ÙˆØ§Ø¦Ù‚ âœ¨
    </div>
  </div>
</div>
<div id="toast" class="toast"></div>
<audio id="bgm" src="https://files.catbox.moe/xx1c3u.mp3" loop preload="none"></audio>

<script>
const RIDER_URL='https://i.ibb.co/1tr7xqfR/Picsart-25-10-16-13-30-56-445.png';
const canvas=document.getElementById('game'),c=canvas.getContext('2d');
const dpr=window.devicePixelRatio||1;
function fixDPI(){const cssW=canvas.clientWidth,cssH=canvas.clientHeight;canvas.width=Math.round(cssW*dpr);canvas.height=Math.round(cssH*dpr);c.setTransform(dpr,0,0,dpr,0,0);}
fixDPI();addEventListener('resize',fixDPI);
const H=()=>canvas.clientHeight,W=()=>canvas.clientWidth,GROUND_Y=()=>H()*0.82;
let running=false,over=false,win=false,dist=0,best=parseInt(localStorage.getItem('fly_best')||'0',10),speed=6;
document.getElementById('best').textContent=best;
const riderImg=new Image();riderImg.crossOrigin='anonymous';let imgOk=false;riderImg.onload=()=>imgOk=true;riderImg.src=RIDER_URL;
const rider={x:80,y:0,w:130,h:84,vy:0,onGround:true,tilt:0};
const obstacles=[];function spawnObstacle(){const gap=160+Math.random()*120;const last=obstacles[obstacles.length-1];const x=last?last.x+last.w+gap:W()+80;const h=24+Math.random()*36,w=22+Math.random()*28;obstacles.push({x,y:GROUND_Y()-h,w,h});}
for(let i=0;i<5;i++)spawnObstacle();
const bgm=document.getElementById('bgm'),soundBtn=document.getElementById('btnSound');let sound=false;
function enableAudioOnce(){if(sound)return;sound=true;bgm.play().then(()=>soundBtn.textContent='ğŸ”ˆ Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ØµÙˆØª').catch(()=>soundBtn.textContent='ğŸ”‡ ØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙˆØª');}
['click','pointerdown','touchstart','keydown'].forEach(ev=>addEventListener(ev,enableAudioOnce,{once:true}));
soundBtn.onclick=()=>{if(bgm.paused){bgm.play();soundBtn.textContent='ğŸ”ˆ Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ØµÙˆØª';}else{bgm.pause();soundBtn.textContent='ğŸ”‡ ØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙˆØª';}};
function jump(){if(!running){startGame();return;}if(!rider.onGround||over)return;rider.vy=-12.5;rider.onGround=false;rider.tilt=-0.18;}
document.getElementById('btnStart').onclick=jump;canvas.addEventListener('pointerdown',jump);
addEventListener('keydown',e=>{if([' ','ArrowUp','w','W'].includes(e.key)){e.preventDefault();jump();}if((e.key==='r'||e.key==='R')&&over)resetGame();});
function physics(){rider.vy+=0.7;rider.y+=rider.vy;if(rider.tilt<0)rider.tilt+=0.02;if(rider.y+rider.h>=GROUND_Y()){rider.y=GROUND_Y()-rider.h;rider.vy=0;rider.onGround=true;rider.tilt=0;}
const rx=rider.x+12,ry=rider.y+8,rw=rider.w-24,rh=rider.h-16;for(const o of obstacles){if(rx<o.x+o.w&&rx+rw>o.x&&ry<o.y+o.h&&ry+rh>o.y){endGame(false);break;}}}
function drawBG(){const y=GROUND_Y(),bottom=H()-y;const sky=c.createLinearGradient(0,0,0,y);sky.addColorStop(0,'#e8f5ff');sky.addColorStop(1,'#f7fbff');c.fillStyle=sky;c.fillRect(0,0,W(),y);const grd=c.createLinearGradient(0,y,0,H());grd.addColorStop(0,'#cfe3d1');grd.addColorStop(1,'#b3d3b9');c.fillStyle=grd;c.fillRect(0,y,W(),bottom);c.strokeStyle='#c6d0db';c.beginPath();c.moveTo(0,y);c.lineTo(W(),y);c.stroke();}
function drawRider(){c.save();const cx=rider.x+rider.w/2,cy=rider.y+rider.h/2;c.translate(cx,cy);c.rotate(rider.tilt);c.translate(-cx,-cy);if(imgOk)c.drawImage(riderImg,rider.x,rider.y,rider.w,rider.h);c.restore();}
function drawObs(){c.fillStyle='#2c3e50';for(const o of obstacles){o.x-=speed;c.fillRect(o.x,o.y,o.w,o.h);}while(obstacles.length&&obstacles[0].x+obstacles[0].w<-20){obstacles.shift();spawnObstacle();}}
let last=0;
function loop(ts){if(!running)return;const dt=(ts-last)/16.67;last=ts;c.clearRect(0,0,W(),H());drawBG();drawObs();physics();drawRider();dist+=Math.max(1,Math.floor(dt));if(dist%120===0)speed=Math.min(12,speed+0.05);document.getElementById('dist').textContent=dist;if(dist>=10000&&!win){endGame(true);return;}requestAnimationFrame(loop);}
function startGame(){if(running)return;overlay.classList.add('hidden');running=true;over=false;win=false;last=performance.now();requestAnimationFrame(loop);}
function endGame(winState){running=false;over=true;win=winState;best=Math.max(best,dist);localStorage.setItem('fly_best',best);document.getElementById('best').textContent=best;if(winState){showToast('ğŸ‰ Ù…Ø¨Ø±ÙˆÙƒ! ÙƒØ³Ø¨Øª ØªÙˆØµÙŠÙ„Ø© Ù…Ø¬Ø§Ù†ÙŠØ©');const msg=encodeURIComponent('Ø£Ù†Ø§ ÙƒØ³Ø¨Øª ØªÙˆØµÙŠÙ„Ù‡ Ù…Ø¬Ø§Ù†ÙŠØ© Ù…Ù† Ù„Ø¹Ø¨Ø© Fly Rider âœ…');setTimeout(()=>{window.location.href='https://wa.me/201017908076?text='+msg;},1000);}else{showToast('ğŸ’¥ Ø­Ø§ÙˆÙ„ ØªØ§Ù†ÙŠ');setTimeout(()=>overlay.classList.remove('hidden'),300);}}
function resetGame(){dist=0;speed=6;rider.y=GROUND_Y()-rider.h;rider.vy=0;rider.onGround=true;rider.tilt=0;obstacles.length=0;for(let i=0;i<5;i++)spawnObstacle();toast.classList.remove('show');running=true;over=false;win=false;last=performance.now();requestAnimationFrame(loop);}
overlay.onclick=()=>over?resetGame():startGame();
function showToast(m){toast.textContent=m;toast.classList.add('show');}
</script>
</body>
</html>
