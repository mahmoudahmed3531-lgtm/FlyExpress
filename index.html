<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Fly Rider â€” Ø§Ù„Ø¹Ø¨ ÙˆØ§ÙƒØ³Ø¨ ØªÙˆØµÙŠÙ„Ø© Ù…Ø¬Ø§Ù†ÙŠØ©</title>
<style>
  :root{
    --sky1:#cfeaff; --sky2:#f6fbff;
    --road1:#cfe3d1; --road2:#b3d3b9;        /* Ø£Ø±Ø¶ Ø£Ø³Ù…Ùƒ */
    --lane:#a7b4c1;
    --ui:#0e2a3d; --text:#063451;
    --card:#ffffff; --muted:#6b879a;
    --accent:#21bf73; --danger:#e74c3c;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; font-family:system-ui,"Segoe UI","Cairo",sans-serif; color:var(--text);
    background:linear-gradient(#eaf6ff,#ffffff);
  }
  .wrap{max-width:960px;margin:0 auto;padding:16px}
  h1{margin:6px 0 4px;font-size:28px;font-weight:900;color:var(--ui);display:flex;gap:10px;align-items:center;justify-content:space-between;flex-wrap:wrap}
  .hud{display:flex;gap:10px;flex-wrap:wrap;margin:8px 0}
  .badge{background:var(--card);border:1px solid #e6eef5;border-radius:14px;padding:10px 14px;font-weight:800;box-shadow:0 6px 14px rgba(0,0,0,.05);color:var(--ui)}
  .btn{background:var(--accent);color:#fff;border:none;border-radius:999px;padding:10px 16px;cursor:pointer;font-weight:900;box-shadow:0 10px 20px rgba(33,191,115,.35)}
  .btn:active{transform:translateY(1px)}
  .btn-outline{background:#f3f8fb;color:#0e2a3d;border:1px solid #e1ecf3}
  .hint{color:#1b4e6b;font-weight:700;margin:6px 0 10px}
  canvas{display:block;width:100%;max-width:960px;height:300px;border-radius:16px;background:transparent;border:1px solid #dfe8f0;box-shadow:0 12px 24px rgba(0,0,0,.06)}
  .overlay{
    position:absolute;inset:0;display:grid;place-items:center;text-align:center;
    background:rgba(255,255,255,.55);backdrop-filter:blur(3px);border-radius:16px;border:1px dashed #cfe0ed;color:var(--ui);font-weight:900
  }
  .overlay.hidden{display:none}
  .toast{
    position:fixed;inset:auto 12px 12px 12px;margin:auto;max-width:540px;
    background:#fff;border:1px solid #e6eef5;border-radius:16px;padding:14px 16px;box-shadow:0 18px 40px rgba(0,0,0,.12);display:none;text-align:center
  }
  .toast.show{display:block;animation:pop .35s ease}
  @keyframes pop{from{transform:translateY(12px);opacity:0}to{transform:translateY(0);opacity:1}}

  /* Ø®Ù„ÙÙŠØ© Ø³Ø­Ø§Ø¨ Ø®ÙÙŠÙ */
  .bg{position:relative;height:0}
  .cloud{position:absolute;top:-68px;width:180px;height:64px;background:#fff;border-radius:40px;filter:blur(.2px);opacity:.9}
  .cloud:before,.cloud:after{content:"";position:absolute;background:#fff;border-radius:50%}
  .cloud:before{width:80px;height:80px;left:18px;top:-30px}
  .cloud:after{width:60px;height:60px;left:100px;top:-20px}
  .s1{left:10%;animation:cloud 30s linear infinite}
  .s2{left:60%;transform:scale(.85);animation:cloud 38s linear infinite}
  @keyframes cloud{from{transform:translateX(0) scale(var(--sc,1))}to{transform:translateX(120vw) scale(var(--sc,1))}}
</style>
</head>
<body>
  <div class="wrap">
    <div class="bg">
      <div class="cloud s1"></div>
      <div class="cloud s2" style="--sc:.9"></div>
    </div>

    <h1>
      <span>ğŸï¸ Fly Rider</span>
      <div style="display:flex;gap:8px">
        <button id="btnSound" class="btn btn-outline">ØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙˆØª ğŸ”Š</button>
        <button id="btnStart" class="btn">Ø§Ø¨Ø¯Ø£</button>
      </div>
    </h1>

    <div class="hud">
      <div class="badge">Ø§Ù„Ù…Ø³Ø§ÙØ©: <span id="score">0</span> / 10000</div>
      <div class="badge">Ø£Ø¹Ù„Ù‰ Ù†ØªÙŠØ¬Ø©: <span id="best">0</span></div>
    </div>

    <div style="position:relative">
      <canvas id="game" width="960" height="300" aria-label="Fly Rider Game"></canvas>

      <div id="overlay" class="overlay">
        <div class="inner">
          <div style="font-size:18px;margin-bottom:6px">Ø§Ø¶ØºØ· <span style="color:#21bf73">Ø§Ø¨Ø¯Ø£</span> Ø£Ùˆ Ø§Ù„Ù…Ø³ Ø§Ù„Ø´Ø§Ø´Ø©</div>
          <div style="font-size:13px;color:#2b5871">Ø§Ù‚ÙØ² Ø¨Ø§Ù„Ù…Ø³/Ø³Ù‡Ù… â†‘ â€” ØªØ¬Ù†Ø¨ Ø§Ù„Ø¹ÙˆØ§Ø¦Ù‚ØŒ ÙˆÙ„Ùˆ ÙˆØµÙ„Øª 10000 Ù†Ù‚Ø·Ø© Ù‡ØªÙƒØ³Ø¨ ØªÙˆØµÙŠÙ„Ø© Ù…Ø¬Ø§Ù†ÙŠØ© ğŸ</div>
        </div>
      </div>
    </div>

    <p class="hint">Ù„Ùˆ Ø®Ø¨Ø·Øª ÙÙŠ Ø¹Ø§Ø¦Ù‚ â€” Ø§Ø¶ØºØ· Ø§Ù„Ø´Ø§Ø´Ø© Ù„Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© âœ¨</p>
  </div>

  <div id="toast" class="toast"></div>

<script>
/* ========= Ø¥Ø¹Ø¯Ø§Ø¯ Ø¹Ø§Ù… ========= */
const RIDER_SRC = 'https://i.ibb.co/0pCGtrP6/Picsart-25-10-16-11-05-31-905.png'; // ØµÙˆØ±ØªÙƒ

const canvas = document.getElementById('game');
const c = canvas.getContext('2d');
const dpi = window.devicePixelRatio || 1;
function fixDPI(){
  const cssW = canvas.clientWidth, cssH = canvas.clientHeight;
  canvas.width = Math.round(cssW * dpi);
  canvas.height = Math.round(cssH * dpi);
  c.setTransform(dpi,0,0,dpi,0,0);
}
fixDPI(); addEventListener('resize', fixDPI);

const W = () => canvas.clientWidth;
const H = () => canvas.clientHeight;
const GROUND_Y = () => H()*0.82;  // Ø®Ø· Ø§Ù„Ø£Ø±Ø¶ (Ø£Ù‚Ø±Ø¨ Ù„Ù„Ø£Ø±Ø¶)
const GOAL = 10000;

let running=false, gameOver=false, won=false;
let score=0, best=parseInt(localStorage.getItem('flyrider_best')||'0',10);
document.getElementById('best').textContent = best;
let speed = 6;

/* ========= Ø§Ù„Ù„Ø§Ø¹Ø¨ (ØµÙˆØ±Ø© + Ø¹Ø¬Ù„Ø§Øª Ø¨ØªÙ„Ù) ========= */
const riderImg = new Image(); riderImg.src = RIDER_SRC;
// Ø­Ø¬Ù…/Ù…ÙƒØ§Ù† Ù…Ù‚Ø±Ø¨ Ù„Ù„Ø£Ø±Ø¶ ÙˆØ¨Ø´ÙƒÙ„ Ø£ÙƒØ¨Ø±
const rider = {
  x: 80, y: 0, w: 190, h: 120,
  vy: 0, onGround: true,
  wheelAngle: 0
};
// Ù…Ø±Ø§ÙƒØ² Ø§Ù„Ø¹Ø¬Ù„ ÙƒÙ†ÙØ³ÙØ¨ Ù…Ù† Ø­Ø¬Ù… Ø§Ù„ØµÙˆØ±Ø© (ØªÙ‚Ø¯Ø± ØªØ¹Ø¯Ù‘Ù„Ù‡Ø§ Ù„Ùˆ Ø­Ø¨ÙŠØª)
const wheelRelative = {
  back:  { x: 0.28, y: 0.83, r: 0.12 }, // Ù†Ø³Ø¨Ø© Ù…Ù† w,h
  front: { x: 0.74, y: 0.85, r: 0.12 }
};

/* ========= Ø¹ÙˆØ§Ø¦Ù‚ Ø¨Ø³ÙŠØ·Ø© ========= */
const obstacles = [];
function spawnObstacle(){
  const gap = 140 + Math.random()*120;
  const last = obstacles[obstacles.length-1];
  const x = last ? last.x + gap + 40 + Math.random()*80 : W() + 60;
  const h = 30 + Math.random()*35;
  const w = 26 + Math.random()*32;
  obstacles.push({ x, y: GROUND_Y()-h, w, h });
}
for(let i=0;i<5;i++) spawnObstacle();

/* ========= ØµÙˆØª Ø¨Ø³ÙŠØ· ========= */
let AC, ctx, gain;
function audioInit(){
  if (ctx) return;
  AC = window.AudioContext || window.webkitAudioContext;
  if (!AC) return;
  ctx = new AC();
  gain = ctx.createGain(); gain.gain.value = 0.18; gain.connect(ctx.destination);
}
function beep(freq=880, dur=0.08, type='square'){
  if (!ctx) return;
  const o=ctx.createOscillator(), g=ctx.createGain();
  o.type=type; o.frequency.value=freq; o.connect(g); g.connect(gain);
  g.gain.setValueAtTime(0.0001, ctx.currentTime);
  g.gain.exponentialRampToValueAtTime(.6, ctx.currentTime+0.01);
  g.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime+dur);
  o.start(); o.stop(ctx.currentTime+dur+0.01);
}

const btnSound = document.getElementById('btnSound');
let soundOn = false;
btnSound.onclick = () => {
  audioInit(); soundOn = !soundOn;
  gain && (gain.gain.value = soundOn ? 0.18 : 0.0);
  btnSound.textContent = soundOn ? 'Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ØµÙˆØª ğŸ”‡' : 'ØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙˆØª ğŸ”Š';
};

/* ========= ØªØ­ÙƒÙ… ========= */
function startGame(){
  if (running) return;
  overlay.classList.add('hidden');
  running = true; gameOver=false; won=false; lastTime=performance.now();
  requestAnimationFrame(loop);
}
function jump(){
  if (!running) startGame();
  if (!rider.onGround || gameOver) return;
  rider.vy = -13; rider.onGround=false;
  if (soundOn) beep(920,.07,'square');
}
addEventListener('keydown', e=>{
  if ([' ','ArrowUp','w','W'].includes(e.key)){ e.preventDefault(); jump(); }
  if ((e.key==='r'||e.key==='R') && gameOver) resetGame();
});
canvas.addEventListener('pointerdown', jump);
['click','touchstart','pointerdown'].forEach(ev=>addEventListener(ev, audioInit, {once:true}));
document.getElementById('btnStart').onclick = jump;

/* ========= Ø±Ø³Ù… Ø§Ù„Ø®Ù„ÙÙŠØ©/Ø§Ù„Ø£Ø±Ø¶ ========= */
function drawBackground(){
  // Ø£Ø±Ø¶ Ø£Ø³Ù…Ùƒ Ø¨Ø·Ø¨Ù‚ØªÙŠÙ†
  const y = GROUND_Y();
  const h = H()-y;
  const grd = c.createLinearGradient(0, y, 0, H());
  grd.addColorStop(0, 'var(--road1)');
  grd.addColorStop(1, 'var(--road2)');
  c.fillStyle = grd;
  c.fillRect(0, y-4, W(), h+4);

  // Ø®Ø· ÙØ§ØµÙ„
  c.strokeStyle = '#c6d0db';
  c.lineWidth = 2;
  c.beginPath(); c.moveTo(0, y); c.lineTo(W(), y); c.stroke();

  // Ø´Ø±Ø§Ø¦Ø· Ø·Ø±ÙŠÙ‚
  c.fillStyle = '#ffffff';
  const segW = 40, gap = 70;
  const offset = - (Date.now()/20 % (segW+gap));
  for(let x=offset; x<W(); x+=segW+gap){
    c.fillRect(x, y-6, segW, 3);
  }
}

/* ========= Ø±Ø³Ù… Ø§Ù„Ù…ÙˆØªÙˆØ³ÙŠÙƒÙ„ + Ø¯ÙˆØ§Ø±Ù† Ø§Ù„Ø¹Ø¬Ù„ ========= */
function drawRider(){
  // Ø¸Ù„ ØªØ­Øª Ø§Ù„Ù…ÙˆØªÙˆØ³ÙŠÙƒÙ„
  c.fillStyle = 'rgba(0,0,0,.12)';
  c.beginPath();
  c.ellipse(rider.x + rider.w*0.55, GROUND_Y()+6, 48, 10, 0, 0, Math.PI*2);
  c.fill();

  // ØµÙˆØ±Ø©
  c.drawImage(riderImg, rider.x, rider.y, rider.w, rider.h);

  // Ø¯ÙˆØ§Ø±Ù† Ø§Ù„Ø¹Ø¬Ù„ (Ø£ÙˆÙØ±Ù„Ø§ÙŠ ÙÙˆÙ‚ Ø§Ù„ØµÙˆØ±Ø©)
  rider.wheelAngle -= speed*0.12; // ÙƒÙ„Ù…Ø§ Ø§Ù„Ø³Ø±Ø¹Ø© Ø²Ø§Ø¯ØªØŒ Ø§Ù„Ø¯ÙˆÙØ±Ø§Ù† Ø£Ø³Ø±Ø¹
  const wheels = ['back','front'];
  c.lineWidth = 2; c.strokeStyle = '#0f2634'; c.fillStyle = '#172d3b';
  wheels.forEach(key=>{
    const rel = wheelRelative[key];
    const cx = rider.x + rider.w*rel.x;
    const cy = rider.y + rider.h*rel.y;
    const r  = rider.w*rel.r;

    // Ø§Ù„Ø¬Ù†Ø· Ø§Ù„Ø¯Ø§ÙƒÙ†
    c.beginPath(); c.arc(cx,cy,r,0,Math.PI*2); c.fill();

    // Ø¥Ø·Ø§Ø± Ø®Ø§Ø±Ø¬ÙŠ
    c.beginPath(); c.arc(cx,cy,r+3,0,Math.PI*2); c.stroke();

    // Ø£Ø´ÙƒØ§Ù„ â€œØ³Ø¨ÙˆÙƒØ³â€ Ø¯ÙˆÙ‘Ø§Ø±Ø©
    c.save();
    c.translate(cx,cy);
    c.rotate(rider.wheelAngle);
    c.strokeStyle = '#e6f2ff';
    for(let i=0;i<4;i++){
      c.rotate(Math.PI/2);
      c.beginPath(); c.moveTo(0,0); c.lineTo(r-5,0); c.stroke();
    }
    c.restore();
  });
}

/* ========= Ø§Ù„Ø¹ÙˆØ§Ø¦Ù‚ ========= */
function drawObstacles(){
  c.fillStyle = '#2c3e50';
  obstacles.forEach(o=>{
    o.x -= speed;
    c.fillRect(o.x, o.y, o.w, o.h);
  });
  // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù‚Ø¯ÙŠÙ… ÙˆØ¥Ø¶Ø§ÙØ© Ø¬Ø¯ÙŠØ¯
  while(obstacles.length && obstacles[0].x + obstacles[0].w < -20){
    obstacles.shift(); spawnObstacle();
  }
}

/* ========= ÙÙŠØ²ÙŠØ§Ø¡ + ØªØµØ§Ø¯Ù… ========= */
function physics(){
  rider.vy += 0.7;
  rider.y += rider.vy;
  if (rider.y + rider.h >= GROUND_Y()){
    rider.y = GROUND_Y() - rider.h;
    rider.vy = 0; rider.onGround = true;
  }

  // ØµÙ†Ø¯ÙˆÙ‚ ØªØµØ§Ø¯Ù… Ø£ØµØºØ± Ù…Ù† Ø§Ù„ØµÙˆØ±Ø©
  const rx = rider.x+24, ry = rider.y+12, rw = rider.w-38, rh = rider.h-18;
  for(const o of obstacles){
    if (rx < o.x + o.w && rx + rw > o.x && ry < o.y + o.h && ry + rh > o.y){
      endGame(false); break;
    }
  }
}

/* ========= Ø­Ù„Ù‚Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© ========= */
let lastTime = 0;
function loop(ts){
  if (!running) return;
  const dt = (ts-lastTime)/16.67; lastTime = ts;

  c.clearRect(0,0,W(),H());
  drawBackground();
  drawObstacles();
  physics();
  drawRider();

  // Ù†Ù‚Ø§Ø· + ØªØ³Ø§Ø±Ø¹ Ø¨Ø³ÙŠØ·
  score += Math.max(1, Math.floor(dt));
  if (score % 120 === 0) speed = Math.min(12, speed + 0.05);
  document.getElementById('score').textContent = score;

  if (score >= GOAL && !won){ endGame(true); return; }
  requestAnimationFrame(loop);
}

/* ========= Ø­Ø§Ù„Ø§Øª ========= */
const overlay = document.getElementById('overlay');
const toast = document.getElementById('toast');

function showToast(msg){ toast.textContent = msg; toast.classList.add('show'); }

function endGame(isWin){
  running=false; gameOver=true; won=isWin;
  best = Math.max(best, score); localStorage.setItem('flyrider_best', best);
  document.getElementById('best').textContent = best;

  if (isWin){
    showToast('ğŸ‰ Ù…Ø¨Ø±ÙˆÙƒ! ÙƒØ³Ø¨Øª ØªÙˆØµÙŠÙ„Ø© Ù…Ø¬Ø§Ù†ÙŠØ© â€” Ø®Ø¯ Ù„Ù‚Ø·Ø© Ø´Ø§Ø´Ø© ÙˆØ§Ø¨Ø¹ØªÙ‡Ø§ Ù„Ù†Ø§ Ø¹Ù„Ù‰ ÙˆØ§ØªØ³Ø§Ø¨ âœ…');
    if (soundOn){ beep(660,.12,'sine'); setTimeout(()=>beep(990,.16,'sine'),120); }
    // ØªØ­ÙˆÙŠÙ„ ÙˆØ§ØªØ³Ø§Ø¨ ØªÙ„Ù‚Ø§Ø¦ÙŠ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ: ÙÙƒ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚)
    // location.href = 'https://wa.me/201017908076?text=' + encodeURIComponent('Ø£Ù†Ø§ ÙƒØ³Ø¨Øª ØªÙˆØµÙŠÙ„Ø© Ù…Ø¬Ø§Ù†ÙŠØ©! ÙˆØµÙ„Øª 10000 ÙÙŠ Ù„Ø¹Ø¨Ø© Fly Rider ğŸ‰');
  }else{
    showToast('ğŸ’¥ Ø£ÙˆÙˆÙˆØ¨Ø³! Ø­Ø§ÙˆÙ„ ØªØ§Ù†ÙŠ â€” Ø§Ø¶ØºØ· Ø§Ù„Ø´Ø§Ø´Ø© Ù„Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©');
    if (soundOn) beep(180,.16,'sawtooth');
  }
  setTimeout(()=>overlay.classList.remove('hidden'), 200);
}

function resetGame(){
  score=0; speed=6;
  rider.y = GROUND_Y()-rider.h; rider.vy=0; rider.onGround=true; rider.wheelAngle=0;
  obstacles.length=0; for(let i=0;i<5;i++) spawnObstacle();
  overlay.classList.add('hidden'); toast.classList.remove('show');
  running=true; gameOver=false; won=false; lastTime=performance.now();
  requestAnimationFrame(loop);
}
overlay.addEventListener('pointerdown', ()=> gameOver ? resetGame() : startGame());

// ØªÙ‡ÙŠØ¦Ø© Ø£ÙˆÙ„ ÙˆØ¶Ø¹
rider.y = GROUND_Y() - rider.h;
</script>
</body>
</html>
