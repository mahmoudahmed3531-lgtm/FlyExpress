<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Fly Rider â€” Ø§Ù„Ø¹Ø¨ ÙˆØ§ÙƒØ³Ø¨ ØªÙˆØµÙŠÙ„Ø© Ù…Ø¬Ø§Ù†ÙŠØ©</title>
<style>
  :root{
    --sky1:#cfeaff; --sky2:#f7fbff;
    --ground:#93d58a; --road:#dfe6ee; --lane:#bac7d3;
    --ink:#0f2a3c; --muted:#476277; --accent:#25d366;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; font-family:system-ui,"Segoe UI","Cairo",sans-serif; color:var(--ink);
    background:linear-gradient(#eef6ff,#ffffff);
  }

  .wrap{max-width:980px;margin:0 auto;padding:18px}
  .top{display:flex;gap:10px;align-items:center;justify-content:space-between;flex-wrap:wrap}
  h1{margin:6px 0;font-size:28px}
  .btn{background:var(--accent);color:#fff;border:none;border-radius:999px;padding:10px 16px;font-weight:800;cursor:pointer}
  .toggle{background:#e9f3ff;color:#123;border-radius:999px;border:0;padding:10px 16px;font-weight:800}
  .badge{background:#fff;border:1px solid #e6edf5;padding:10px 14px;border-radius:14px;font-weight:800;box-shadow:0 6px 16px rgba(0,0,0,.05)}
  .hint{margin:10px 0 0;color:var(--muted);font-weight:700}

  .stage{position:relative}
  canvas{display:block;width:100%;max-width:980px;height:300px;border:1px solid #e3ebf3;border-radius:16px;background:transparent;box-shadow:0 12px 28px rgba(0,0,0,.06)}

  /* Ø®Ù„ÙÙŠØ© Ù…ØªØ­Ø±ÙƒØ© (Ø³Ù…Ø§ + Ø·Ø±ÙŠÙ‚) */
  .bg{position:fixed;inset:0;z-index:-1;background: linear-gradient(180deg,var(--sky1) 0%, var(--sky2) 62%, var(--road) 62%, var(--lane) 69%, var(--road) 69%, var(--ground) 100%);}
  .cloud{position:absolute;top:12%;width:180px;height:60px;background:#fff;border-radius:40px;filter:blur(.2px);opacity:.95}
  .cloud:before,.cloud:after{content:"";position:absolute;background:#fff;border-radius:50%}
  .cloud:before{width:80px;height:80px;left:20px;top:-30px}
  .cloud:after{width:60px;height:60px;left:100px;top:-20px}
  .c1{left:110%;animation:cloud 28s linear infinite}
  .c2{top:20%;left:130%;transform:scale(.85);animation:cloud 34s linear infinite}
  .c3{top:26%;left:150%;transform:scale(1.1);animation:cloud 42s linear infinite}
  @keyframes cloud{to{transform:translateX(-260%)}}

  /* Overlay */
  .overlay{
    position:absolute;inset:0;display:grid;place-items:center;text-align:center;
    background:rgba(255,255,255,.55);backdrop-filter:blur(3px);border-radius:16px;border:1px dashed #cfe0ed;color:#153245;font-weight:900
  }
  .overlay.hidden{display:none}
  .overlay .inner{padding:14px}
  .small{font-size:12px;opacity:.8;margin-top:6px}

  /* Toast */
  .toast{
    position:fixed;inset:auto 12px 12px 12px;margin:auto;max-width:520px;
    background:#fff;border:1px solid #e6eef5;border-radius:16px;padding:14px 16px;
    box-shadow:0 18px 40px rgba(0,0,0,.12);display:none;text-align:center;font-weight:800
  }
  .toast.show{display:block;animation:pop .35s ease}
  @keyframes pop{from{transform:translateY(12px);opacity:0}to{transform:translateY(0);opacity:1}}
</style>
</head>
<body>
  <div class="bg">
    <div class="cloud c1"></div>
    <div class="cloud c2"></div>
    <div class="cloud c3"></div>
  </div>

  <div class="wrap">
    <div class="top">
      <button id="btnStart" class="btn">Ø§Ø¨Ø¯Ø£</button>
      <button id="btnAudio" class="toggle">ğŸ”Š ØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙˆØª</button>
      <h1>Fly Rider ğŸï¸ â€” <span style="color:#16a34a">Ø§Ù„Ø¹Ø¨ ÙˆØ§ÙƒØ³Ø¨ ØªÙˆØµÙŠÙ„Ø© Ù…Ø¬Ø§Ù†ÙŠØ©</span></h1>
    </div>

    <div class="top" style="margin-top:6px">
      <div class="badge">Ø§Ù„Ù…Ø³Ø§ÙØ©: <b><span id="score">0</span> / 10000</b></div>
      <div class="badge">Ø£Ø¹Ù„Ù‰ Ù†ØªÙŠØ¬Ø©: <b id="best">0</b></div>
      <div class="badge">Ø§Ù„Ù‚ÙØ²: Ø§Ù„Ù…Ø³Ø§ÙØ©/Ø³Ù‡Ù… â†‘ Ø£Ùˆ Ù„Ù…Ø³Ø©</div>
    </div>

    <p class="hint">Ø£Ø¹Ø¯Ø§Ø¡ Ø·Ø§Ø¦Ø±Ø© + Ø±ØµØ§Øµ â€” ØªÙØ§Ø¯Ø§Ù‡Ù… Ù„Ø­Ø¯ Ù…Ø§ ØªÙˆØµÙ„ Ù„Ù„Ù†Ù‡Ø§ÙŠØ© ÙˆØªÙƒØ³Ø¨ Ø§Ù„ØªÙˆØµÙŠÙ„Ø© ğŸ</p>

    <div class="stage" style="margin-top:10px">
      <canvas id="game" width="980" height="300" aria-label="Fly Rider Game"></canvas>
      <div id="overlay" class="overlay">
        <div class="inner">
          <div style="font-size:20px;margin-bottom:6px">Ø§Ø¶ØºØ· <span style="color:#2ecc71">Ø§Ø¨Ø¯Ø£</span> Ø£Ùˆ Ø§Ù„Ù…Ø³ Ø§Ù„Ø´Ø§Ø´Ø© Ù„Ù„Ø§Ù†Ø·Ù„Ø§Ù‚</div>
          <div class="small">Ø§Ù„Ù‡Ø¯Ù: <b>10,000</b> Ù†Ù‚Ø·Ø© â€” ÙŠØ§ÙØ·Ø© Ø¨Ù„Ø¯ ÙƒÙ„ <b>1000</b><br/>ØªØ¬Ù†Ù‘Ø¨ Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¡ ÙÙŠ Ø§Ù„Ø³Ù…Ø§Ø¡ ÙˆØ§Ù„Ø±ØµØ§Øµ ğŸ‘€</div>
        </div>
      </div>
    </div>
  </div>

  <div id="toast" class="toast"></div>

<script>
/* ================= Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¹Ø§Ù…Ø© ================= */
const SUCCESS_POINTS   = 10000;
const WHATSAPP_NUMBER  = '201017908076'; // Ø¨Ø¯ÙˆÙ† Ø¹Ù„Ø§Ù…Ø© +
const SUCCESS_MESSAGE  = 'Ø£Ù†Ø§ ÙƒØ³Ø¨Øª ØªÙˆØµÙŠÙ„Ø© Ù…Ø¬Ø§Ù†ÙŠØ© Ù…Ù† Ù„Ø¹Ø¨Ø© Fly Rider!';
const RIDER_SRC        = 'https://i.ibb.co/0pCGtrP6/Picsart-25-10-16-11-05-31-905.png'; // ØµÙˆØ±Ø© Ø§Ù„Ø³Ø§Ø¦Ù‚

/* ================= Ø¹Ù†Ø§ØµØ± Ø±Ø¦ÙŠØ³ÙŠØ© ================= */
const canvas = document.getElementById('game');
const c = canvas.getContext('2d');
const dpi = window.devicePixelRatio||1;
function fixDPI(){ const w=canvas.clientWidth,h=canvas.clientHeight; canvas.width=Math.round(w*dpi); canvas.height=Math.round(h*dpi); c.setTransform(dpi,0,0,dpi,0,0); }
fixDPI(); addEventListener('resize', fixDPI);

const W=()=>canvas.clientWidth, H=()=>canvas.clientHeight, GROUND_Y=()=>H()*0.78;

let running=false, gameOver=false, won=false;
let score=0, best=parseInt(localStorage.getItem('fly_best')||'0',10);
document.getElementById('best').textContent=best;
let speed=6;

/* ================= Ø§Ù„Ù„Ø§Ø¹Ø¨ ÙˆØ§Ù„Ø¹ÙˆØ§Ø¦Ù‚ ================= */
const riderImg=new Image(); let riderReady=false;
riderImg.onload=()=>{ riderReady=true; };
riderImg.src=RIDER_SRC;

const rider={x:80,y:0,w:120,h:90,vy:0,onGround:true,tilt:0};

const obstacles=[], bullets=[], signs=[];
function spawnObstacle(){
  const last=obstacles[obstacles.length-1];
  const gap=160+Math.random()*140;
  const x= last ? last.x+gap : W()+120;
  const h=26+Math.random()*34, w=24+Math.random()*30;
  obstacles.push({x,y:GROUND_Y()-h,w,h});
}
for(let i=0;i<5;i++) spawnObstacle();

function spawnBullet(){
  const x=W()+20, y=40+Math.random()*120;
  bullets.push({x,y,w:10,h:3,vy:(Math.random()>.5?1:-1)*.6});
}
setInterval(()=>{ if(running && Math.random()<.5) spawnBullet(); }, 900);

function addSignIfNeeded(){
  const next=Math.floor(score/1000);
  if(!signs.includes(next) && next>0 && next<10){
    signs.push(next);
    signs['s'+next]={x:W()+20,y:GROUND_Y()-40,label:`Ø¨Ù„Ø¯ ${next*1000}`};
  }
}

/* ================= ØµÙˆØª Ø¨Ø³ÙŠØ· ================= */
let AC, ctx, gain, audioOn=false;
function initAudio(){ if(ctx) return; AC=window.AudioContext||window.webkitAudioContext; if(!AC) return; ctx=new AC(); gain=ctx.createGain(); gain.gain.value=.12; gain.connect(ctx.destination); }
function beep(f=880,d=.08,type='square'){ if(!ctx || !audioOn) return; const o=ctx.createOscillator(), g=ctx.createGain(); o.type=type; o.frequency.value=f; o.connect(g); g.connect(gain); g.gain.setValueAtTime(0.0001,ctx.currentTime); g.gain.exponentialRampToValueAtTime(.6,ctx.currentTime+.01); g.gain.exponentialRampToValueAtTime(0.0001,ctx.currentTime+d); o.start(); o.stop(ctx.currentTime+d+.01); }

/* ================= ØªØ­ÙƒÙ… ================= */
function jump(){ if(!running) startGame(); if(!rider.onGround || gameOver) return; rider.vy=-13; rider.onGround=false; rider.tilt=-12; beep(920,.09,'square'); }
addEventListener('keydown',e=>{ if([' ','ArrowUp','w','W'].includes(e.key)){ e.preventDefault(); jump(); }});
canvas.addEventListener('pointerdown',jump);
document.getElementById('btnStart').addEventListener('click',jump);
document.getElementById('btnAudio').addEventListener('click',()=>{ audioOn=!audioOn; initAudio(); document.getElementById('btnAudio').textContent= audioOn ? 'ğŸ”ˆ Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ØµÙˆØª' : 'ğŸ”Š ØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙˆØª'; });
['click','touchstart','pointerdown'].forEach(ev=>addEventListener(ev,initAudio,{once:true}));

/* ================= Ø±Ø³Ù… ================= */
function drawBackground(){
  const y=GROUND_Y();
  c.strokeStyle='#cbd6e2'; c.lineWidth=2; c.beginPath(); c.moveTo(0,y); c.lineTo(W(),y); c.stroke();
  c.fillStyle='#fff'; const seg=40, gap=70, off=-(Date.now()/20 % (seg+gap));
  for(let x=off; x<W(); x+=seg+gap) c.fillRect(x,y-6,seg,3);
  c.fillStyle='rgba(0,0,0,.12)'; c.beginPath(); c.ellipse(rider.x+rider.w*.52,y+6,42,9,0,0,Math.PI*2); c.fill();
}
function drawRider(){
  rider.tilt += (0 - rider.tilt)*0.08;
  c.save();
  c.translate(rider.x+rider.w/2, rider.y+rider.h/2);
  c.rotate(rider.tilt*Math.PI/180);
  c.translate(-rider.w/2,-rider.h/2);
  if(riderReady){ c.drawImage(riderImg,0,0,rider.w,rider.h); }
  else{
    // Ø¨Ø¯ÙŠÙ„ Ø¨Ø³ÙŠØ· Ù„Ø­Ø¯ Ù…Ø§ Ø§Ù„ØµÙˆØ±Ø© ØªØ¬Ù‡Ø²
    c.fillStyle='#0f2a3c'; c.fillRect(10,28,90,10);
    c.fillStyle='#25c2dd'; c.fillRect(40,15,26,22);
    c.fillStyle='#222'; c.fillRect(50,2,10,16);
    c.fillStyle='#f2c19b'; c.fillRect(52,6,6,8);
    c.fillStyle='#0f2a3c'; c.beginPath(); c.arc(22,54,12,0,Math.PI*2); c.fill(); c.beginPath(); c.arc(88,54,12,0,Math.PI*2); c.fill();
  }
  c.restore();
}
function drawObstacles(){ c.fillStyle='#2d3e50'; obstacles.forEach(o=>{ o.x-=speed; c.fillRect(o.x,o.y,o.w,o.h); }); while(obstacles.length && obstacles[0].x+obstacles[0].w<-20){ obstacles.shift(); spawnObstacle(); } }
function drawBullets(){ c.fillStyle='#3b82f6'; bullets.forEach(b=>{ b.x-=speed*1.2; b.y+=b.vy; c.fillRect(b.x,b.y,b.w,b.h); }); while(bullets.length && bullets[0].x+bullets[0].w<-20) bullets.shift(); }
function drawSigns(){ for(const k in signs){ if(k.startsWith('s')){ const s=signs[k]; s.x-=speed; c.fillStyle='#1e3a8a'; c.fillRect(s.x,s.y,70,36); c.fillStyle='#93c5fd'; c.fillRect(s.x+6,s.y+6,58,24); } } }

/* ================= ÙÙŠØ²ÙŠØ§Ø¡ + ØªØµØ§Ø¯Ù… ================= */
function physics(){
  rider.vy += .7; rider.y += rider.vy;
  if(rider.y + rider.h >= GROUND_Y()){ rider.y = GROUND_Y()-rider.h; rider.vy=0; rider.onGround=true; }
  const rx=rider.x+12, ry=rider.y+6, rw=rider.w-24, rh=rider.h-12;
  for(const o of obstacles){ if(rx<o.x+o.w && rx+rw>o.x && ry<o.y+o.h && ry+rh>o.y){ endGame(false); return; } }
  for(const b of bullets){ if(rx<b.x+b.w && rx+rw>b.x && ry<b.y+b.h && ry+rh>b.y){ endGame(false); return; } }
}

/* ================= Ø­Ù„Ù‚Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© ================= */
let last=0;
function loop(ts){
  if(!running) return;
  const dt=(ts-last)/16.67; last=ts;
  c.clearRect(0,0,W(),H());
  drawBackground(); drawObstacles(); drawBullets(); physics(); drawRider(); drawSigns();
  score += Math.max(1, Math.floor(dt)); if(score%100===0) speed=Math.min(12,speed+.05);
  document.getElementById('score').textContent=score; addSignIfNeeded();
  if(score>=SUCCESS_POINTS && !won){ endGame(true); return; }
  requestAnimationFrame(loop);
}

/* ================= Ø­Ø§Ù„Ø§Øª ================= */
const overlay=document.getElementById('overlay'); const toast=document.getElementById('toast');
function showToast(msg){ toast.textContent=msg; toast.classList.add('show'); }
function startGame(){ if(running) return; overlay.classList.add('hidden'); running=true; gameOver=false; won=false; last=performance.now(); requestAnimationFrame(loop); }
function resetGame(){ score=0; speed=6; rider.y=GROUND_Y()-rider.h; rider.vy=0; rider.onGround=true; obstacles.length=0; for(let i=0;i<5;i++) spawnObstacle(); bullets.length=0; signs.length=0; overlay.classList.add('hidden'); toast.classList.remove('show'); running=true; gameOver=false; won=false; last=performance.now(); requestAnimationFrame(loop); }
function endGame(isWin){
  running=false; gameOver=true; won=isWin;
  best=Math.max(best,score); localStorage.setItem('fly_best',best); document.getElementById('best').textContent=best;
  if(isWin){
    showToast('ğŸ‰ Ù…Ø¨Ø±ÙˆÙƒ! ÙƒØ³Ø¨Øª ØªÙˆØµÙŠÙ„Ø© Ù…Ø¬Ø§Ù†ÙŠØ© â€” Ø¬Ø§Ø±Ù ØªØ­ÙˆÙŠÙ„Ùƒ Ù„Ù„ÙˆØ§ØªØ³Ø§Ø¨ Ù„Ù„ØªØ£ÙƒÙŠØ¯ âœ…');
    beep(660,.15,'sine'); setTimeout(()=>beep(990,.18,'sine'),120);
    setTimeout(()=>{ const msg=encodeURIComponent(`${SUCCESS_MESSAGE} â€” Ù†ØªÙŠØ¬ØªÙŠ: ${score}`); location.href=`https://wa.me/${WHATSAPP_NUMBER}?text=${msg}`; },1200);
  }else{
    showToast('ğŸ’¥ Ø£ÙˆÙˆÙˆØ¨Ø³! Ø­Ø§ÙˆÙ„ ØªØ§Ù†ÙŠ â€” Ø§Ø¶ØºØ· Ø§Ù„Ø´Ø§Ø´Ø© Ù„Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©');
    beep(160,.2,'sawtooth'); setTimeout(()=>overlay.classList.remove('hidden'),200);
  }
}
overlay.addEventListener('pointerdown', ()=> gameOver ? resetGame() : startGame());
/* ØªÙ…ÙˆØ¶Ø¹ Ø£ÙˆÙ„ÙŠ */
rider.y = GROUND_Y() - rider.h;
</script>
</body>
</html>
