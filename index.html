<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Fly Rider â€” Ø§Ù„Ø¹Ø¨ ÙˆØ§Ø±Ø¨Ø­ ØªÙˆØµÙŠÙ„Ø© Ù…Ø¬Ø§Ù†ÙŠØ©</title>
<style>
  :root{
    --sky1:#cceaff; --sky2:#f6fbff;
    --ground:#8bd17c; --road:#d9dfe8; --lane:#b7c3cf;
    --text:#063451; --ui:#0e2a3d;
    --accent:#2ecc71; --danger:#e74c3c;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; background:linear-gradient(#eaf6ff,#ffffff);
    font-family:system-ui, -apple-system, "Segoe UI", Cairo, Roboto, sans-serif;
    color:var(--text); overflow:hidden;
  }

  /* Ø®Ù„ÙÙŠØ© Ù†Ù‡Ø§Ø±ÙŠØ© */
  .bg{
    position:fixed; inset:0; z-index:-1; overflow:hidden;
    background: linear-gradient(180deg,var(--sky1) 0%, var(--sky2) 60%, var(--road) 60%, var(--lane) 68%, var(--road) 68%, var(--ground) 100%);
  }
  .cloud{position:absolute; top:10%; width:180px; height:60px; background:#fff; border-radius:40px; filter:blur(.2px); opacity:.9}
  .cloud:before,.cloud:after{content:""; position:absolute; background:#fff; border-radius:50%}
  .cloud:before{width:80px;height:80px; left:20px; top:-30px}
  .cloud:after{width:60px;height:60px; left:100px; top:-20px}
  .cloud.s1{top:12%; left:110%; animation:cloud 28s linear infinite}
  .cloud.s2{top:20%; left:130%; transform:scale(.8); animation:cloud 36s linear infinite}
  .cloud.s3{top:26%; left:150%; transform:scale(1.1); animation:cloud 42s linear infinite}
  @keyframes cloud{to{transform:translateX(-260%)}}

  .wrap{max-width:960px; margin:0 auto; padding:18px}
  h1{
    margin:4px 0 8px; font-size:24px; font-weight:900; color:var(--ui);
    display:flex; gap:8px; align-items:center; justify-content:space-between;
  }
  .hint{margin:0 0 10px; color:#1b4e6b; font-weight:700}
  .hud{display:flex; gap:10px; align-items:center; justify-content:space-between; flex-wrap:wrap}
  .badge{background:#fff;border:1px solid #e6eef5; padding:8px 12px; border-radius:12px; font-weight:800; color:var(--ui); box-shadow:0 6px 16px rgba(0,0,0,.05)}
  .btn{background:var(--accent); color:#fff; font-weight:900; border:none; border-radius:999px; padding:10px 16px; cursor:pointer; box-shadow:0 10px 20px rgba(46,204,113,.35)}
  .btn:active{transform:translateY(1px)}
  canvas{display:block; width:100%; max-width:960px; height:280px; border-radius:16px; background:transparent; border:1px solid #dfe8f0; box-shadow:0 12px 30px rgba(0,0,0,.06)}
  .bar{display:flex; gap:8px; align-items:center; margin:10px 0}

  /* Ø±Ø³Ø§Ù„Ø© Ø§Ù„ÙÙˆØ² */
  .toast{
    position:fixed; inset:auto 12px 12px 12px; margin:auto; max-width:520px;
    background:#fff; border:1px solid #e6eef5; border-radius:16px; padding:14px 16px;
    box-shadow:0 18px 40px rgba(0,0,0,.12); display:none; text-align:center;
  }
  .toast.show{display:block; animation:pop .35s ease}
  @keyframes pop{from{transform:translateY(12px);opacity:0}to{transform:translateY(0);opacity:1}}

  /* Ø´Ø§Ø´Ø© Ø§Ù„Ø¨Ø¯Ø¡ / Ø§Ù„Ù†Ù‡Ø§ÙŠØ© */
  .overlay{
    position:absolute; inset:0; display:grid; place-items:center; text-align:center;
    background:rgba(255,255,255,.55); backdrop-filter:blur(3px); border-radius:16px; border:1px dashed #cfe0ed;
    color:var(--ui); font-weight:900;
  }
  .overlay.hidden{display:none}
  .overlay .inner{padding:14px}
  .small{font-size:12px; opacity:.8; margin-top:6px}
</style>
</head>
<body>
  <div class="bg">
    <div class="cloud s1"></div>
    <div class="cloud s2"></div>
    <div class="cloud s3"></div>
  </div>

  <div class="wrap">
    <h1>ğŸ® Fly Rider <button id="btnStart" class="btn">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨Ø©</button></h1>
    <div class="bar hud">
      <div class="badge">Ø§Ù„Ù†Ù‚Ø§Ø·: <span id="score">0</span></div>
      <div class="badge">Ø£Ø¹Ù„Ù‰ Ù†ØªÙŠØ¬Ø©: <span id="best">0</span></div>
      <div class="badge">Ø§Ù„Ù‡Ø¯Ù: 3000 Ù†Ù‚Ø·Ø©</div>
      <div class="badge">Ø§Ù„Ù‚ÙØ²: Ø§Ù„Ù…Ø³Ø§ÙØ©/Ø³Ù‡Ù… â†‘ Ø£Ùˆ Ù„Ù…Ø³Ø©</div>
    </div>

    <div style="position:relative">
      <canvas id="game" width="960" height="280" aria-label="Fly Rider Game"></canvas>
      <div id="overlay" class="overlay">
        <div class="inner">
          <div style="font-size:20px; margin-bottom:6px">Ø§Ø¶ØºØ· <span style="color:#2ecc71">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨Ø©</span> Ø£Ùˆ Ø§Ù„Ù…Ø³ Ø§Ù„Ø´Ø§Ø´Ø©</div>
          <div class="small">Ø§Ù‚ÙØ² ÙÙˆÙ‚ Ø§Ù„Ø¹ÙˆØ§Ø¦Ù‚. Ù„Ùˆ ÙˆØµÙ„Øª 3000 Ù†Ù‚Ø·Ø©: <span style="color:#e67e22">Ù…Ø¨Ø±ÙˆÙƒ ØªÙˆØµÙŠÙ„Ø© Ù…Ø¬Ø§Ù†ÙŠØ©!</span></div>
        </div>
      </div>
    </div>

    <p class="hint">Ù„Ùˆ Ø§Ù„Ù…ÙˆØªÙˆØ³ÙŠÙƒÙ„ Ø®Ø¨Ø· ÙÙŠ Ø¹Ø§Ø¦Ù‚ â€” ØªÙ‚Ø¯Ø± ØªØ¹ÙŠØ¯ ÙÙˆØ±Ù‹Ø§ ÙˆØ­Ø§ÙˆÙ„ ØªÙƒØ³Ø± Ø§Ù„Ø±Ù‚Ù…! ğŸ˜‰</p>
  </div>

  <div id="toast" class="toast"></div>

<script>
const RIDER_SRC = 'https://i.ibb.co/fG4LmWnD/images-3-5.jpg';

const canvas = document.getElementById('game');
const c = canvas.getContext('2d');
const dpi = window.devicePixelRatio || 1;
function fixDPI(){
  const cssH = canvas.clientHeight, cssW = canvas.clientWidth;
  canvas.width = Math.round(cssW * dpi);
  canvas.height = Math.round(cssH * dpi);
  c.setTransform(dpi,0,0,dpi,0,0);
}
fixDPI(); addEventListener('resize', fixDPI);

const W = () => canvas.clientWidth;
const H = () => canvas.clientHeight;

let running = false, gameOver = false, won = false;
let score = 0, best = parseInt(localStorage.getItem('flyrider_best')||'0',10);
document.getElementById('best').textContent = best;

const GROUND_Y = () => H()*0.78;
let speed = 6;

const riderImg = new Image();
riderImg.src = RIDER_SRC;
const rider = { x: 80, y: 0, w: 120, h: 80, vy: 0, onGround: true };

const obstacles = [];
function spawnObstacle(){
  const gap = 140 + Math.random()*120;
  const last = obstacles[obstacles.length-1];
  const x = last ? last.x + gap + 40 + Math.random()*80 : W() + 60;
  const h = 30 + Math.random()*35;
  const w = 26 + Math.random()*30;
  obstacles.push({ x, y: GROUND_Y()-h, w, h });
}
for(let i=0;i<5;i++) spawnObstacle();

const groundDots = Array.from({length:24}, (_,i)=>({x:i*60 + Math.random()*50, y:GROUND_Y()+12+Math.random()*16}));

function jump(){
  if (!running) startGame();
  if (!rider.onGround || gameOver) return;
  rider.vy = -13; rider.onGround = false;
}
addEventListener('keydown', e=>{
  if ([' ', 'ArrowUp', 'w', 'W'].includes(e.key)){ e.preventDefault(); jump(); }
  if (e.key==='r' || e.key==='R'){ if (gameOver) resetGame(); }
});
canvas.addEventListener('pointerdown', jump);
document.getElementById('btnStart').addEventListener('click', jump);

function drawBackground(){
  const y = GROUND_Y();
  c.strokeStyle = '#c6d0db';
  c.lineWidth = 2;
  c.beginPath();
  c.moveTo(0, y); c.lineTo(W(), y); c.stroke();

  c.fillStyle = '#ffffff';
  const segW = 40, gap = 70;
  const offset = - (Date.now()/20 % (segW+gap));
  for(let x=offset; x<W(); x+=segW+gap){
    c.fillRect(x, y-6, segW, 3);
  }

  c.fillStyle = '#a7b4c1';
  groundDots.forEach(d=>{
    d.x -= speed*0.3; if (d.x<-10) d.x = W()+Math.random()*60;
    c.fillRect(d.x, y+8+Math.sin(d.x*0.05)*2, 6, 2);
  });
}

function drawRider(){
  const y = rider.y;
  c.fillStyle = 'rgba(0,0,0,.12)';
  c.beginPath();
  c.ellipse(rider.x + rider.w*0.55, GROUND_Y()+6, 46, 10, 0, 0, Math.PI*2);
  c.fill();
  c.drawImage(riderImg, rider.x, y, rider.w, rider.h);
}

function drawObstacles(){
  c.fillStyle = '#2c3e50';
  obstacles.forEach(o=>{
    o.x -= speed;
    c.fillRect(o.x, o.y, o.w, o.h);
  });

  while(obstacles.length && obstacles[0].x + obstacles[0].w < -20){
    obstacles.shift(); spawnObstacle();
  }
}

function physics(){
  rider.vy += 0.7;
  rider.y += rider.vy;
  if (rider.y + rider.h >= GROUND_Y()){
    rider.y = GROUND_Y() - rider.h;
    rider.vy = 0; rider.onGround = true;
  }

  const rx = rider.x+18, ry = rider.y+8, rw = rider.w-28, rh = rider.h-12;
  for(const o of obstacles){
    if (rx < o.x + o.w && rx + rw > o.x && ry < o.y + o.h && ry + rh > o.y){
      endGame(false);
      break;
    }
  }
}

let lastTime = 0;
function loop(ts){
  if (!running) return;
  const dt = (ts-lastTime)/16.67; lastTime = ts;

  c.clearRect(0,0,W(),H());
  drawBackground();
  drawObstacles();
  physics();
  drawRider();

  score += Math.max(1, Math.floor(dt));
  if (score % 100 === 0) speed = Math.min(12, speed + 0.05);

  document.getElementById('score').textContent = score;

  if (score >= 3000 && !won){
    endGame(true);
    return;
  }

  requestAnimationFrame(loop);
}

const overlay = document.getElementById('overlay');
const toast = document.getElementById('toast');

function startGame(){
  if (running) return;
  overlay.classList.add('hidden');
  running = true; gameOver = false; won = false; lastTime = performance.now();
  requestAnimationFrame(loop);
}

function endGame(isWin){
  running = false; gameOver = true; won = isWin;
  best = Math.max(best, score); localStorage.setItem('flyrider_best', best);
  document.getElementById('best').textContent = best;

  if (isWin){
    showToast('ğŸ‰ Ù…Ø¨Ø±ÙˆÙƒ! ÙƒØ³Ø¨Øª ØªÙˆØµÙŠÙ„Ø© Ù…Ø¬Ø§Ù†ÙŠØ© ğŸšš â€” Ù„Ù‚Ø·Ø© Ø´Ø§Ø´Ø© ÙˆØ§Ø±Ø³Ù„Ù‡Ø§ Ø¹Ù„Ù‰ ÙˆØ§ØªØ³Ø§Ø¨ âœ…');
  }else{
    showToast('ğŸ’¥ Ø®Ø¨Ø·Øª ÙÙŠ Ø¹Ø§Ø¦Ù‚ â€” Ø§Ø¶ØºØ· Ù„Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©');
  }

  setTimeout(()=>{ overlay.classList.remove('hidden'); }, 200);
}

function resetGame(){
  score = 0; speed = 6;
  rider.y = GROUND_Y() - rider.h; rider.vy = 0; rider.onGround = true;
  obstacles.length = 0; for(let i=0;i<5;i++) spawnObstacle();
  overlay.classList.add('hidden'); toast.classList.remove('show');
  running = true; gameOver = false; won = false; lastTime = performance.now();
  requestAnimationFrame(loop);
}

overlay.addEventListener('pointerdown', ()=> gameOver ? resetGame() : startGame());

function showToast(msg){
  toast.textContent = msg;
  toast.classList.add('show');
}

rider.y = GROUND_Y() - rider.h;
</script>
</body>
</html>
