<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Fly Express — أسرع توصيل في نجع حمادي</title>

  <meta name="description" content="Fly Express: دليفري سريع في نجع حمادي — اطلب مشوارك فورًا عبر واتساب.">
  <meta name="theme-color" content="#0a1622">
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link rel="icon" href="https://i.ibb.co/B5MQWCWF/fly-express.jpg"/>

  <style>
    :root{--text:#eaf1f6;--muted:#b8c0c9}
    *{box-sizing:border-box}
    body{
      margin:0;color:var(--text);font-family:'Cairo',system-ui,sans-serif;
      background:
        radial-gradient(1100px 600px at 10% 10%, #0d1b2a 0%, transparent 65%),
        radial-gradient(1100px 600px at 90% 90%, #001219 0%, transparent 65%),
        conic-gradient(from 0deg at 50% 50%, #00111a, #001a2b, #0a2a43, #001a2b, #00111a);
      min-height:100vh;padding:22px;overflow-x:hidden;
    }
    .container{max-width:940px;margin:0 auto;position:relative;z-index:1}
    .card{background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.1);padding:18px;border-radius:18px;margin:12px 0}

    /* header */
    .header{display:flex;align-items:center;gap:14px}
    .header img{width:80px;height:80px;border-radius:14px;border:1px solid rgba(255,255,255,.12);object-fit:cover}
    .header h1{margin:0;font-size:34px;line-height:1;font-weight:900}
    .header p{margin:6px 0 0;color:#cfe2ee}

    /* banner */
    .banner{background:linear-gradient(90deg,#00d27a,#00a8ff);color:#001316;border-radius:18px;display:flex;justify-content:space-between;align-items:center;gap:12px}

    /* games */
    .games .trigger{
      width:100%;border:1px solid rgba(255,255,255,.08);
      background:linear-gradient(90deg,#2bb7ff,#4b8bff);color:#fff;
      padding:14px 16px;border-radius:18px;font-weight:900;display:flex;align-items:center;justify-content:space-between;cursor:pointer
    }
    .games .menu{display:none;gap:10px;margin-top:10px}
    .games .menu.show{display:grid}
    .games .menu a{
      display:flex;align-items:center;justify-content:space-between;gap:10px;
      padding:12px 14px;border-radius:16px;text-decoration:none;color:#fff;
      border:1px solid rgba(255,255,255,.08)
    }
    .g1{background:linear-gradient(90deg,#7b2fff,#ff2ea6)}
    .g2{background:linear-gradient(90deg,#00d27a,#00a8ff)}
    .g3{background:linear-gradient(90deg,#ff8ad6,#9a7bff)}
    .g4{background:linear-gradient(90deg,#22d3ee,#34d399)}

    /* rating */
    .stars{user-select:none;margin:6px 0 2px}
    .stars span{font-size:30px;color:#8894a4;cursor:pointer;transition:.15s}
    .stars span.active{color:#ffcc00;transform:scale(1.15)}
    .input, .textarea{
      width:100%;padding:12px;border-radius:12px;margin-top:10px;
      border:1px solid rgba(255,255,255,.12);background:rgba(255,255,255,.05);color:#fff
    }
    .textarea{min-height:110px}
    .btn{width:100%;padding:12px;border:0;border-radius:999px;font-weight:900;cursor:pointer}
    .btn.primary{background:linear-gradient(90deg,#00ffaa,#00a8ff);color:#001316}
    .btn.secondary{background:linear-gradient(90deg,#d4e4ff,#bfffd8);color:#003b35}
    .feedbacks{margin-top:10px;max-height:240px;overflow:auto}
    .feedback{background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.08);padding:10px;border-radius:10px;margin-bottom:8px}
    .feedback strong{color:#21f5b3}

    /* popup */
    .popup-bg{display:none;position:fixed;inset:0;background:rgba(0,0,0,.7);z-index:9998;align-items:center;justify-content:center}
    .popup{background:#0a1a25;border-radius:18px;padding:20px;max-width:420px;width:92%;max-height:80vh;overflow:auto;border:1px solid rgba(255,255,255,.12);position:relative}
    .popup h3{text-align:center;margin:0 0 10px}
    .popup .close{position:absolute;top:12px;inset-inline-end:16px;background:transparent;border:0;color:#fff;font-size:24px;cursor:pointer}

    /* overlay & drawers (orders/prices) */
    .overlay{position:fixed;inset:0;background:rgba(0,0,0,.5);display:none;z-index:9997}
    .overlay.show{display:block}
    .drawer{position:fixed;top:0;right:-420px;width:min(420px,92vw);height:100vh;z-index:9999;background:rgba(10,20,28,.96);color:#eaf1f6;border-left:1px solid rgba(255,255,255,.06);box-shadow:-20px 0 50px rgba(0,0,0,.45);transition:right .28s ease;display:flex;flex-direction:column}
    .drawer.open{right:0}
    .drawer-head{padding:16px 16px 10px;display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid rgba(255,255,255,.06)}
    .drawer-title{font-weight:900;font-size:20px}
    .drawer-close{background:transparent;border:0;color:#fff;font-size:24px;cursor:pointer}
    .drawer-body{padding:14px;overflow:auto}
    .order-card{background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.08);border-radius:14px;padding:12px;margin-bottom:12px}
    .order-card h3{margin:0 0 8px;font-size:16px}
    .order-row{display:grid;grid-template-columns:1fr 1fr;gap:8px}
    .order-row.single{grid-template-columns:1fr}
    .order-input,.order-select,.order-textarea{width:100%;padding:10px 12px;border-radius:12px;border:1px solid rgba(255,255,255,.12);background:rgba(255,255,255,.06);color:#fff;font-family:inherit;font-size:14px}
    .order-textarea{min-height:68px;resize:vertical}
    .order-actions{display:flex;gap:8px;margin-top:10px}
    .order-btn{flex:1;border:0;cursor:pointer;padding:10px 14px;border-radius:999px;font-weight:900;color:#001316;background:linear-gradient(90deg,#00ffaa,#00a8ff)}
    .order-btn.secondary{background:linear-gradient(90deg,#d4e4ff,#bfffd8);color:#003b35}
    .order-badge{display:inline-flex;gap:6px;align-items:center;background:#0ea5e9;color:#001316;padding:4px 10px;border-radius:999px;font-weight:900;font-size:12px}

    /* prices */
    .price-note{color:#b8c0c9;font-size:13px;margin-bottom:8px}
    .price-grid{display:grid;gap:10px}
    .price-item{display:flex;align-items:center;justify-content:space-between;gap:12px;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.08);border-radius:12px;padding:12px}
    .price-item .name{font-weight:800}
    .price-item .price{background:linear-gradient(90deg,#00ffaa,#00a8ff);color:#001316;padding:6px 12px;border-radius:999px;font-weight:900}

    /* floating menu */
    .menu-fab{position:fixed;right:18px;top:50%;transform:translateY(-50%);width:58px;height:58px;border-radius:50%;background:#f59e0b;display:flex;align-items:center;justify-content:center;font-size:22px;color:#fff;z-index:10000;cursor:pointer;border:0;box-shadow:0 0 20px rgba(255,255,255,.25)}
    .menu-pop{position:fixed;right:86px;top:50%;transform:translateY(-50%);background:rgba(255,255,255,.12);border:1px solid rgba(255,255,255,.18);border-radius:16px;padding:8px;display:none;z-index:10001;backdrop-filter:blur(8px)}
    .menu-pop.show{display:block}
    .menu-item{display:flex;align-items:center;gap:8px;padding:10px 12px;border-radius:12px;color:#001316;background:linear-gradient(90deg,#e7ffef,#c8ffd9);font-weight:900;cursor:pointer;margin:6px 0;white-space:nowrap}
    .menu-item.secondary{background:linear-gradient(90deg,#d7fff6,#cfe8ff)}

    /* socials (old style) */
    .socials{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .sbtn{
      display:flex;align-items:center;justify-content:space-between;padding:14px;border-radius:18px;
      border:1px solid rgba(255,255,255,.08);text-decoration:none;color:#fff;font-weight:700
    }
    .fb{background:linear-gradient(90deg,#1877f2,#2bbf3a)}
    .wa{background:linear-gradient(90deg,#25D366,#ffd166)}
    .ig{background:linear-gradient(90deg,#b277ff,#2b8cff)}
    .tg{background:linear-gradient(90deg,#2b8cff,#27ae60)}
    .fp{background:linear-gradient(90deg,#00d27a,#21f5b3)}
    .sbtn i:last-child{opacity:.95}
    @media(max-width:640px){.socials{grid-template-columns:1fr}}
  </style>
</head>

<body>
  <div class="container">
    <!-- الهيدر -->
    <div class="card header">
      <img src="https://i.ibb.co/B5MQWCWF/fly-express.jpg" alt="Fly Express">
      <div>
        <h1>Fly Express</h1>
        <p>التوصيل الأسرع في نجع حمادي</p>
      </div>
    </div>

    <!-- بانر -->
    <div class="banner card">
      <b>🚀 أسرع خدمة توصيل في نجع حمادي.</b>
      <small>خدمة يومية طوال الأسبوع</small>
    </div>

    <!-- الألعاب -->
    <div class="card">
      <h2>العب و اكسب توصيلة مجانية 🎮</h2>
      <div class="games">
        <button id="gamesToggle" class="trigger" aria-expanded="false" aria-controls="gamesMenu">
          <span>اضغط لاختيار لعبة</span>
          <i class="fa-solid fa-caret-down"></i>
        </button>
        <div id="gamesMenu" class="menu" aria-hidden="true">
          <a class="g1" href="https://mahmoudahmed3531-lgtm.github.io/FlyExpress2/" target="_blank" rel="noopener">
            <span><i class="fa-solid fa-bullseye"></i> لعبة الطرود — Whack-a-Parcel</span>
            <i class="fa-solid fa-arrow-up-right-from-square"></i>
          </a>
          <a class="g2" href="https://mahmoudahmed3531-lgtm.github.io/FlyRiderGame/" target="_blank" rel="noopener">
            <span><i class="fa-solid fa-motorcycle"></i> لعبة الموتسيكل — Fly Rider</span>
            <i class="fa-solid fa-arrow-up-right-from-square"></i>
          </a>
          <a class="g3" href="https://mahmoudahmed3531-lgtm.github.io/FlyRushGame/" target="_blank" rel="noopener">
            <span><i class="fa-regular fa-face-smile-beam"></i> لعبة الذاكرة — Fly Rush</span>
            <i class="fa-solid fa-arrow-up-right-from-square"></i>
          </a>
          <a class="g4" href="https://mahmoudahmed3531-lgtm.github.io/Super-mario-/" target="_blank" rel="noopener">
            <span><i class="fa-solid fa-circle-question"></i> لعبة الأسئلة — من سيربح التوصيلات</span>
            <i class="fa-solid fa-arrow-up-right-from-square"></i>
          </a>
        </div>
      </div>
    </div>

    <!-- تقييم الخدمة -->
    <div class="card">
      <h2>⭐ قيّم خدمتنا</h2>
      <div class="stars" id="stars">
        <span data-val="1">★</span>
        <span data-val="2">★</span>
        <span data-val="3">★</span>
        <span data-val="4">★</span>
        <span data-val="5">★</span>
      </div>
      <input class="input" id="name" placeholder="اسمك (اختياري)">
      <textarea class="textarea" id="comment" placeholder="اكتب رأيك في الخدمة..."></textarea>
      <button class="btn primary" id="submit">إرسال التقييم</button>
      <button class="btn secondary" id="showAll">عرض كل التقييمات</button>
      <div class="feedbacks" id="feedbacks"></div>
    </div>

    <!-- Popup التقييمات -->
    <div class="popup-bg" id="popupBg">
      <div class="popup">
        <button class="close" id="popupClose">&times;</button>
        <h3>كل التقييمات 🗒️</h3>
        <div id="allFeedbacks"></div>
      </div>
    </div>

    <!-- منصّات التواصل (5 أزرار) -->
    <div class="card">
      <h2>منصّات التواصل 🔗</h2>
      <div class="socials">
        <a class="sbtn fb" href="https://www.facebook.com/profile.php?id=61582010826944&mibextid=ZbWKwL" target="_blank" rel="noopener">
          <span><i class="fa-brands fa-facebook-f"></i> صفحة فيسبوك</span>
          <i class="fa-solid fa-arrow-up-right-from-square"></i>
        </a>
        <a class="sbtn wa" href="https://wa.me/201017908076" target="_blank" rel="noopener">
          <span><i class="fa-brands fa-whatsapp"></i> واتساب</span>
          <i class="fa-solid fa-arrow-up-right-from-square"></i>
        </a>
        <a class="sbtn ig" href="https://www.instagram.com/habis_namla/" target="_blank" rel="noopener">
          <span><i class="fa-brands fa-instagram"></i> إنستجرام</span>
          <i class="fa-solid fa-arrow-up-right-from-square"></i>
        </a>
        <a class="sbtn tg" href="https://t.me/D_M_C0" target="_blank" rel="noopener">
          <span><i class="fa-brands fa-telegram"></i> تليجرام</span>
          <i class="fa-solid fa-arrow-up-right-from-square"></i>
        </a>
        <a class="sbtn fp" href="https://www.facebook.com/share/16X3GTzQE6/" target="_blank" rel="noopener">
          <span><i class="fa-brands fa-facebook"></i> فيسبوك الشخصي</span>
          <i class="fa-solid fa-arrow-up-right-from-square"></i>
        </a>
      </div>
    </div>

    <p id="visits" style="text-align:center;margin:8px 0;color:#b8c0c9;"></p>
    <footer style="text-align:center;margin:18px 0;color:#b8c0c9">© Fly Express — أسرع توصيل في نجع حمادي</footer>
  </div>

  <!-- الزر العائم + القائمة -->
  <button class="menu-fab" id="menuFab" title="قائمة سريعة"><i class="fa-solid fa-ellipsis-vertical"></i></button>
  <div class="menu-pop" id="menuPop" role="menu" aria-hidden="true">
    <div class="menu-item" id="miFast"><i class="fa-solid fa-bolt"></i> طلب توصيل (سريع)</div>
    <div class="menu-item secondary" id="miMonthly"><i class="fa-solid fa-calendar-days"></i> جدول شهري</div>
    <div class="menu-item" id="miPrices"><i class="fa-solid fa-tags"></i> الأسعار</div>
  </div>

  <!-- Overlay موحد -->
  <div class="overlay" id="overlay"></div>

  <!-- درج الطلبات السريعة -->
  <aside class="drawer" id="orderDrawer" dir="rtl" aria-label="درج الطلبات">
    <div class="drawer-head">
      <div class="drawer-title">قائمة الطلبات</div>
      <button class="drawer-close" data-close>&times;</button>
    </div>
    <div class="drawer-body">
      <!-- 1) توصيل ابني المدرسة -->
      <div class="order-card">
        <h3>🏫 توصيل ابني المدرسة <span class="order-badge">جديد</span></h3>
        <div class="order-row">
          <select class="order-select" id="schoolType">
            <option value="ذهاب فقط">ذهاب فقط</option>
            <option value="ذهاب وعودة">ذهاب وعودة</option>
          </select>
          <input class="order-input" id="schoolChild" placeholder="اسم الطالب" required>
        </div>
        <div class="order-row">
          <input class="order-input" id="schoolPhone" placeholder="رقم ولي الأمر" inputmode="tel" pattern="^(\+?20)?1[0-9]{9}$" required>
          <input class="order-input" id="schoolFrom" placeholder="العنوان: من" required>
        </div>
        <div class="order-row">
          <input class="order-input" id="schoolTo" placeholder="العنوان: إلى (المدرسة)" required>
          <input class="order-input" id="schoolNote" placeholder="ملاحظات (اختياري)">
        </div>
        <div class="order-actions">
          <button class="order-btn" onclick="sendSchool()">تأكيد وإرسال على واتساب</button>
          <button class="order-btn secondary" onclick="clearSchool()">مسح</button>
        </div>
      </div>

      <!-- 2) توصيل أوردر / طرد -->
      <div class="order-card">
        <h3>📦 توصيل أوردر / طرد</h3>
        <div class="order-row">
          <select class="order-select" id="orderKind"><option value="أوردر">أوردر</option><option value="طرد">طرد</option></select>
          <select class="order-select" id="orderAction"><option value="هنجيبه">هنجيبه</option><option value="هنوّصله">هنوّصله</option></select>
        </div>
        <div class="order-row">
          <input class="order-input" id="orderFrom" placeholder="العنوان: من" required>
          <input class="order-input" id="orderTo" placeholder="العنوان: إلى" required>
        </div>
        <div class="order-row">
          <input class="order-input" id="orderName" placeholder="اسمك" required>
          <input class="order-input" id="orderPhone" placeholder="رقم الموبايل" inputmode="tel" pattern="^(\+?20)?1[0-9]{9}$" required>
        </div>
        <div class="order-row">
          <input class="order-input" id="orderWhen" placeholder="الوقت المفضل (مثال: الآن/5 مساء)">
          <input class="order-input" id="orderNote" placeholder="وصف المحتوى/ملاحظات (اختياري)">
        </div>
        <div class="order-actions">
          <button class="order-btn" onclick="sendOrder()">تأكيد وإرسال على واتساب</button>
          <button class="order-btn secondary" onclick="clearOrder()">مسح</button>
        </div>
      </div>

      <!-- 3) طلبات السوق -->
      <div class="order-card">
        <h3>🛒 طلبات السوق</h3>
        <div class="order-row single">
          <textarea class="order-textarea" id="marketList" placeholder="اكتب قائمة الطلبات بالتفصيل" required></textarea>
        </div>
        <div class="order-row">
          <input class="order-input" id="marketFrom" placeholder="من أي سوق/محل؟ (اختياري)">
          <input class="order-input" id="marketTo" placeholder="عنوان التوصيل" required>
        </div>
        <div class="order-row">
          <input class="order-input" id="marketName" placeholder="اسمك" required>
          <input class="order-input" id="marketPhone" placeholder="رقم الموبايل" inputmode="tel" pattern="^(\+?20)?1[0-9]{9}$" required>
        </div>
        <div class="order-row">
          <input class="order-input" id="marketWhen" placeholder="الوقت المفضل">
          <input class="order-input" id="marketNote" placeholder="ملاحظات (اختياري)">
        </div>
        <div class="order-actions">
          <button class="order-btn" onclick="sendMarket()">تأكيد وإرسال على واتساب</button>
          <button class="order-btn secondary" onclick="clearMarket()">مسح</button>
        </div>
      </div>

      <!-- 4) توصيل طرد -->
      <div class="order-card">
        <h3>📮 توصيل طرد</h3>
        <div class="order-row">
          <select class="order-select" id="parcelAction"><option value="هنجيبه">هنجيبه</option><option value="هنوديه">هنوديه</option></select>
          <input class="order-input" id="parcelName" placeholder="اسمك" required>
        </div>
        <div class="order-row">
          <input class="order-input" id="parcelPhone" placeholder="رقم الموبايل" inputmode="tel" pattern="^(\+?20)?1[0-9]{9}$" required>
          <input class="order-input" id="parcelFrom" placeholder="العنوان: من" required>
        </div>
        <div class="order-row">
          <input class="order-input" id="parcelTo" placeholder="العنوان: إلى" required>
          <input class="order-input" id="parcelNote" placeholder="وصف الطرد/تعليمات (اختياري)">
        </div>
        <div class="order-actions">
          <button class="order-btn" onclick="sendParcel()">تأكيد وإرسال على واتساب</button>
          <button class="order-btn secondary" onclick="clearParcel()">مسح</button>
        </div>
      </div>
    </div>
  </aside>

  <!-- درج الجدول الشهري -->
  <aside class="drawer" id="monthlyDrawer" dir="rtl" aria-label="الجدول الشهري">
    <div class="drawer-head">
      <div class="drawer-title">📘 جدول توصيل الأبناء (شهري)</div>
      <button class="drawer-close" data-close>&times;</button>
    </div>
    <div class="drawer-body">
      <div class="order-row single" style="margin-bottom:10px;color:#b8c0c9">املأ البيانات وسيتم إرسالها على واتساب للإدارة.</div>
      <div class="order-row">
        <input class="order-input" id="pmName" placeholder="اسم ولي الأمر" required>
        <input class="order-input" id="pmPhone" placeholder="رقم موبايل ولي الأمر" inputmode="tel" pattern="^(\+?20)?1[0-9]{9}$" required>
      </div>
      <div class="order-row">
        <input class="order-input" id="pmChildrenCount" placeholder="عدد الأبناء" inputmode="numeric" required>
        <input class="order-input" id="pmStreet" placeholder="شارع كام (اسم/رقم)" required>
      </div>
      <div class="order-row">
        <select class="order-select" id="pmDirection">
          <option value="هتوصلهم وتجيبهم">هتوصلهم وتجيبهم</option>
          <option value="هتوصلهم فقط">هتوصلهم فقط</option>
          <option value="هتجيبهم فقط">هتجيبهم فقط</option>
        </select>
        <input class="order-input" id="pmLessonsPerWeek" placeholder="كم حصة في الأسبوع" inputmode="numeric" required>
      </div>
      <div class="order-row single">
        <textarea class="order-textarea" id="pmLessonsTime" placeholder="ميعاد الحصص (مثال: سبت-اتنين-أربع 7:30 صباحًا)" required></textarea>
      </div>
      <div class="order-actions">
        <button class="order-btn" id="sendMonthly">تأكيد وإرسال واتساب</button>
        <button class="order-btn secondary" id="clearMonthly">مسح</button>
      </div>
      <div style="font-size:12px;color:#b8c0c9;margin-top:6px">لو عندك أكتر من شارع/أيام مختلفة اكتبهم في خانة المواعيد.</div>
    </div>
  </aside>

  <!-- درج الأسعار -->
  <aside class="drawer" id="pricesDrawer" dir="rtl" aria-label="الأسعار">
    <div class="drawer-head">
      <div class="drawer-title">💰 قائمة الأسعار</div>
      <button class="drawer-close" data-close>&times;</button>
    </div>
    <div class="drawer-body">
      <div class="price-note">* الأسعار التالية <b>تقديرية</b> وقد تختلف حسب المسافة والوقت. للتأكيد النهائي تواصل معنا على واتساب.</div>
      <div class="price-grid">
        <div class="price-item">
          <div class="name">داخل نجع حمادي</div>
          <div class="price">15–20 ج</div>
        </div>
        <div class="price-item">
          <div class="name">القرى القريبة (بهجورة/أولاد نجم..)</div>
          <div class="price">25–35 ج</div>
        </div>
        <div class="price-item">
          <div class="name">خارج المركز</div>
          <div class="price">بالإتفاق</div>
        </div>
        <div class="price-item">
          <div class="name">اشتراك شهري للمدارس (ذهاب وعودة)</div>
          <div class="price">يبدأ من 300 ج</div>
        </div>
        <div class="price-item">
          <div class="name">طلبات السوق/المشاوير الخاصة</div>
          <div class="price">حسب القائمة</div>
        </div>
      </div>

      <div class="order-actions" style="margin-top:12px">
        <button class="order-btn" onclick="window.open('https://wa.me/201017908076','_blank')">
          تواصل لتأكيد السعر على واتساب
        </button>
      </div>
    </div>
  </aside>

  <script>
    /* ===== الألعاب ===== */
    const gamesToggle=document.getElementById('gamesToggle');
    const gamesMenu=document.getElementById('gamesMenu');
    gamesToggle.addEventListener('click',()=>{
      const open=gamesMenu.classList.toggle('show');
      gamesToggle.setAttribute('aria-expanded',open?'true':'false');
      gamesMenu.setAttribute('aria-hidden',open?'false':'true');
    });
    document.addEventListener('click',(e)=>{
      if(!gamesToggle.contains(e.target) && !gamesMenu.contains(e.target)){
        gamesMenu.classList.remove('show');
        gamesToggle.setAttribute('aria-expanded','false');
        gamesMenu.setAttribute('aria-hidden','true');
      }
    });

    /* ===== التقييم ===== */
    const stars=document.querySelectorAll('#stars span');
    let rating=0;
    stars.forEach(s=>s.addEventListener('click',()=>{
      rating=s.dataset.val;
      stars.forEach(st=>st.classList.toggle('active', +st.dataset.val<=rating));
    }));
    const nameInput=document.getElementById('name');
    const commentInput=document.getElementById('comment');
    const feedbacks=document.getElementById('feedbacks');
    const showAll=document.getElementById('showAll');
    const popupBg=document.getElementById('popupBg');
    const popupClose=document.getElementById('popupClose');
    const allFeedbacks=document.getElementById('allFeedbacks');

    function renderLists(){
      const list=(JSON.parse(localStorage.getItem('feedbackList')||'[]'));
      feedbacks.innerHTML=list.slice(-3).reverse().map(f=>(
        `<div class="feedback"><strong>${f.name||'زائر'}</strong> (${f.rate}⭐): ${f.comment}</div>`
      )).join('') || '<p style="color:#b8c0c9">لا توجد تقييمات بعد.</p>';
      allFeedbacks.innerHTML=list.slice().reverse().map(f=>(
        `<div class="feedback"><strong>${f.name||'زائر'}</strong> (${f.rate}⭐) — <small>${f.date}</small><br>${f.comment}</div>`
      )).join('') || '<p style="color:#b8c0c9">لا توجد تقييمات بعد.</p>';
    }
    document.getElementById('submit').onclick=()=>{
      const nm=nameInput.value.trim();
      const cm=commentInput.value.trim();
      if(!rating || !cm){ alert('من فضلك اختر عدد النجوم واكتب تعليق.'); return; }
      const list=(JSON.parse(localStorage.getItem('feedbackList')||'[]'));
      list.push({name:nm,comment:cm,rate:rating,date:new Date().toLocaleString()});
      localStorage.setItem('feedbackList',JSON.stringify(list));
      nameInput.value=''; commentInput.value=''; rating=0; stars.forEach(st=>st.classList.remove('active'));
      renderLists();
      alert('✅ تم إضافة تقييمك بنجاح!');
    };
    showAll.onclick=()=>{ popupBg.style.display='flex'; };
    popupClose.onclick=()=>{ popupBg.style.display='none'; };
    popupBg.onclick=(e)=>{ if(e.target===popupBg) popupBg.style.display='none'; };
    renderLists();

    /* ===== الأدراج + الزر العائم ===== */
    const overlay=document.getElementById('overlay');
    const orderDrawer=document.getElementById('orderDrawer');
    const monthlyDrawer=document.getElementById('monthlyDrawer');
    const pricesDrawer=document.getElementById('pricesDrawer');

    function openDrawer(el){ el.classList.add('open'); overlay.classList.add('show'); }
    function closeAll(){
      orderDrawer.classList.remove('open');
      monthlyDrawer.classList.remove('open');
      pricesDrawer.classList.remove('open');
      overlay.classList.remove('show');
    }
    overlay.addEventListener('click', closeAll);
    document.querySelectorAll('[data-close]').forEach(b=>b.addEventListener('click',closeAll));

    const menuFab=document.getElementById('menuFab');
    const menuPop=document.getElementById('menuPop');
    const miFast=document.getElementById('miFast');
    const miMonthly=document.getElementById('miMonthly');
    const miPrices=document.getElementById('miPrices');

    menuFab.addEventListener('click',(e)=>{
      e.stopPropagation();
      const open=!menuPop.classList.contains('show');
      menuPop.classList.toggle('show',open);
      menuPop.setAttribute('aria-hidden',open?'false':'true');
    });
    document.addEventListener('click',(e)=>{
      if(!menuFab.contains(e.target) && !menuPop.contains(e.target)){
        menuPop.classList.remove('show');
        menuPop.setAttribute('aria-hidden','true');
      }
    });
    miFast.addEventListener('click',()=>{ menuPop.classList.remove('show'); openDrawer(orderDrawer); });
    miMonthly.addEventListener('click',()=>{ menuPop.classList.remove('show'); openDrawer(monthlyDrawer); });
    miPrices.addEventListener('click',()=>{ menuPop.classList.remove('show'); openDrawer(pricesDrawer); });

    /* ===== إرسال واتساب للطلبات ===== */
    const ADMIN_PHONE="201017908076";
    const enc=s=>encodeURIComponent(s||"");
    const waSend=txt=>window.open(`https://wa.me/${ADMIN_PHONE}?text=${enc(txt)}`,'_blank','noopener');

    function ensureRequired(ids){
      for(const id of ids){
        const el=document.getElementById(id);
        if(el && !el.value.trim()){ el.focus(); alert('من فضلك أكمل الحقول المطلوبة'); return false; }
      }
      return true;
    }

    function sendSchool(){
      if(!ensureRequired(['schoolChild','schoolPhone','schoolFrom','schoolTo'])) return;
      const t=document.getElementById('schoolType').value;
      const child=document.getElementById('schoolChild').value;
      const phone=document.getElementById('schoolPhone').value;
      const from=document.getElementById('schoolFrom').value;
      const to=document.getElementById('schoolTo').value;
      const note=document.getElementById('schoolNote').value;
      const text=`طلب توصيل مدرسة 🏫
النوع: ${t}
الطالب: ${child}
ولي الأمر: ${phone}
من: ${from}
إلى: ${to}
ملاحظات: ${note||'—'}
— أُرسل من موقع Fly Express`;
      waSend(text);
    }
    function clearSchool(){['schoolChild','schoolPhone','schoolFrom','schoolTo','schoolNote'].forEach(id=>document.getElementById(id).value="");}

    function sendOrder(){
      if(!ensureRequired(['orderFrom','orderTo','orderName','orderPhone'])) return;
      const kind=document.getElementById('orderKind').value;
      const act=document.getElementById('orderAction').value;
      const from=document.getElementById('orderFrom').value;
      const to=document.getElementById('orderTo').value;
      const name=document.getElementById('orderName').value;
      const phone=document.getElementById('orderPhone').value;
      const when=document.getElementById('orderWhen').value;
      const note=document.getElementById('orderNote').value;
      const text=`طلب ${kind} ${act} 📦
الاسم: ${name} — ${phone}
من: ${from}
إلى: ${to}
الوقت: ${when||'أقرب وقت'}
ملاحظات: ${note||'—'}
— أُرسل من موقع Fly Express`;
      waSend(text);
    }
    function clearOrder(){['orderFrom','orderTo','orderName','orderPhone','orderWhen','orderNote'].forEach(id=>document.getElementById(id).value="");}

    function sendMarket(){
      if(!ensureRequired(['marketList','marketTo','marketName','marketPhone'])) return;
      const list=document.getElementById('marketList').value;
      const from=document.getElementById('marketFrom').value;
      const to=document.getElementById('marketTo').value;
      const name=document.getElementById('marketName').value;
      const phone=document.getElementById('marketPhone').value;
      const when=document.getElementById('marketWhen').value;
      const note=document.getElementById('marketNote').value;
      const text=`طلبات سوق 🛒
العميل: ${name} — ${phone}
القائمة:
${list}

من: ${from||'—'}
إلى: ${to}
الوقت: ${when||'أقرب وقت'}
ملاحظات: ${note||'—'}
— أُرسل من موقع Fly Express`;
      waSend(text);
    }
    function clearMarket(){['marketList','marketFrom','marketTo','marketName','marketPhone','marketWhen','marketNote'].forEach(id=>document.getElementById(id).value="");}

    function sendParcel(){
      if(!ensureRequired(['parcelName','parcelPhone','parcelFrom','parcelTo'])) return;
      const act=document.getElementById('parcelAction').value;
      const from=document.getElementById('parcelFrom').value;
      const to=document.getElementById('parcelTo').value;
      const name=document.getElementById('parcelName').value;
      const phone=document.getElementById('parcelPhone').value;
      const note=document.getElementById('parcelNote').value;
      const text=`توصيل طرد (${act}) 📮
العميل: ${name} — ${phone}
من: ${from}
إلى: ${to}
ملاحظات: ${note||'—'}
— أُرسل من موقع Fly Express`;
      waSend(text);
    }
    function clearParcel(){['parcelFrom','parcelTo','parcelName','parcelPhone','parcelNote'].forEach(id=>document.getElementById(id).value="");}

    // عدّاد زيارات بسيط
    const visits=+localStorage.getItem("visitsCount")||0;
    localStorage.setItem("visitsCount",visits+1);
    document.getElementById("visits").textContent=`👀 عدد زياراتك من هذا الجهاز: ${visits+1}`;
  </script>
</body>
</html>
